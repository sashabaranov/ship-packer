# This is a script to build environment for SHiP in slc-like vm
# To start in docker:
#      docker-machine create -d virtualbox --virtualbox-memory 4096 ship
#      docker-machine env ship  # <---- save exports to your .bash_profile
#      docker run -ti hepsw/slc-base:6.5 /bin/bash
# (in container):
#      curl https://gist.githubusercontent.com/sashabaranov/7afaf541db6f0bbede7e/raw/f53b2ddf8668435618e72ac96698695d9ce3ef3b/build_ship.sh > build_ship.sh
#      source build_ship.sh

yum -y install \
    which file bc bash-completion man \
    unzip tar patch \
    cmake \
    gcc-c++ \
    gcc-gfortran \
    compat-gcc-34-g77 \
    git subversion \
    xorg-x11-xauth \
    libX11-devel libXpm-devel libXmu-devel libXft-devel libXext-devel \
    mesa-libGL-devel mesa-libGLU-devel \
    expat-devel \
    python-devel \
    libxml2-devel \
    python-mtTkinter \
    vim


# rm /usr/lib/gcc/x86_64-redhat-linux/3.4.6/libgcc_s_32.so  # references non-existent file
# cp /usr/lib/gcc/x86_64-redhat-linux/3.4.6/lib* /usr/local/lib

yum -y install x11vnc libpng xterm twm
yum -y install openssl openssl-devel openssl-CERN-CA-certs
yum -y install curl libcurl libcurl-openssl automake autoconf aclocal libcurl-devel libtool cmake bzip2 bzip2-devel

export SHIPSOFT=/opt/ocean
export FAIRROOTPATH=$SHIPSOFT/FairRootInst
export SIMPATH=$SHIPSOFT/FairSoftInst
export FAIRSHIP=$SHIPSOFT/FairShip
export PYTHONPATH=$FAIRSHIP/python:$SIMPATH/lib:$SIMPATH/lib/Geant4:$PYTHONPATH


# mkdir -p $HOME/FairSoft $HOME/FairRoot /opt/ocean/FairShip /opt/ocean/FairShipRun
mkdir -p $SHIPSOFT


git clone -b dev https://github.com/ShipSoft/FairSoft.git $SHIPSOFT/FairSoft
cd $SHIPSOFT/FairSoft
echo 1 | ./configure.sh


ls -lah $SIMPATH/bin/
export PATH=$SIMPATH/bin:$PATH
source $SIMPATH/bin/thisroot.sh

git clone -b dev https://github.com/ShipSoft/FairRoot.git $SHIPSOFT/FairRoot
cd $SHIPSOFT/FairRoot
./configure.sh



# mkdir build
# cd build
# cmake -DCMAKE_INSTALL_PREFIX="$FAIRROOTPATH" ..
# make
# make install


git clone https://github.com/ShipSoft/FairShip.git $FAIRSHIP
cd $FAIRSHIP
./configure
# mkdir -p $SHIPSOFT/FairShipRun
# cd $SHIPSOFT/FairShipRun
# cmake $FAIRSHIP
# make

# cleanup
rm -rf $SHIPSOFT/FairSoft
rm -rf $SHIPSOFT/FairRoot
